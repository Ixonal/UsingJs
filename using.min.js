/*
UsingJs script loader and dependency tracker
Copyright 2013 Benjamin McGregor
Released under the MIT Licence
*/
(function(f,g,q){function G(){if(1>=arguments.length)throw Error("At least an extender and extendee are required");var a=arguments[0],b,c,d;for(c=1;c<arguments.length;c++)if(b=arguments[c])for(d in b)a[d]=b[d];return a}function v(){var a=arguments[0],b,c,d;if(!a||a.constructor!==Array)throw Error("The mergee must be an array.");for(c=1;c<arguments.length;c++){b=arguments[c];if(!b||b.constructor!==Array)throw Error("The merger must be an array.");if(b)for(d=0;d<b.length;d++)a.push(b[d])}}function A(a,
b){for(var c=0;c<a.length;c++)if(a[c].matches(b))return c;return-1}function h(a){return typeof a===H?a.constructor===f.Array?0<a.length?I+"<"+h(a[0])+">":I+"<object>":a.constructor===f.RegExp?L:a.constructor===f.Date?M:a.src?k:H:typeof a}function N(){if(!f.navigator)return{i:null};var a={name:O,version:null},b;if(b=P.exec(f.navigator.userAgent))a.name=B,a.version=+b[1];else if(b=Q.exec(f.navigator.userAgent))a.name=R,a.version=+b[1];else if(b=S.exec(f.navigator.userAgent))a.name=T,a.version=+b[1];
else if(b=U.exec(f.navigator.userAgent))a.name=V,a.version=+b[1];return{i:a}}function J(){g=G({},W,g,N());var a=X();if(null===a)throw Error("Could not locate the using.js script include. \nPlease specify the name of the source file in the configuration.");var b=a.getAttribute("data-script-root"),c=a.getAttribute("data-style-root"),d=a.getAttribute("data-using"),a=a.getAttribute("data-style-using");b&&"/"!==b.substr(b.length-1,1)&&(b+="/");g.F=b||"/";c&&"/"!==c.substr(c.length-1,1)&&(c+="/");g.G=c||
"/";d&&(g.w=eval.call(null,"("+d+")"));a&&(g.v=eval.call(null,"("+a+")"))}function X(){var a,b,c=w.getElementsByTagName("script"),d,e=["using.js","using.min.js",g.S];for(a=0;a<c.length;a++)for(d=c[a].src,b=0;b<e.length;b++)if(d.substr(d.length-e[b].length,e[b].length)===e[b])return c[a];return null}function K(a,b){var c=""+a,d;d=c&&(7<=c.length&&"http://"===c.substr(0,7).toLowerCase()||8<=c.length&&"https://"===c.substr(0,8).toLowerCase())?f.location?(d=Y.exec(c))&&(d[1]!==f.location.protocol||d[2]!==
f.location.host):!0:!1;if(d)return c;c.substr(c.length-b.length)!==b&&(c+="."+b);"/"===c.substr(0,1)&&(c=c.substr(1));switch(b){case r:return g.F+c;case l:return g.G+c;default:return"/"+c}}function u(a,b){this.src=a;this.type=b||r;this.g=[];this.e=[];this.b=[]}function e(a,b){var c,d,f,p,t,q=s.empty();switch(h(a)){case "function":return e.C(a);case m:case k:case x:case y:c=C.h(a);break;default:throw Error("Valid dependencies must be entered");}f=[];q?(t=new u(D,D),t.p()):g.i.name===B&&10>=g.i.version&&
(t=s.L());for(d=c.length-1;0<=d;d--){p=s.q(c[d]);if(!p){p=c[d];var n;a:{n=c[d];switch(h(n)){case m:n=Z.test(n)?r:$.test(n)?l:r;break a;case k:n=n.type||r;break a}n=void 0}p=new u(p,n);s.s(p);p.p()}f.push(p)}if(t){for(d=f.length-1;0<=d;d--)t.o(f[d]);b&&t.n(b)}else{c=new u(z+aa++,z);s.s(c);for(d=f.length-1;0<=d;d--)c.o(f[d]);b&&c.n(b);c.p();q||E.push(c)}return e}var W={M:!1,F:"/",G:"/"},E=[],w=f.document,H="object",m="string",I="array",x="array<string>",y="array<dependency>",k="dependency",M="date",
L="regexp",r="js",l="css",z="usingContext",D="page",P=/MSIE\s*(\d+)/i,Q=/Chrome\/(\d+)/i,S=/Firefox\/(\d+)/i,U=/Safari\/(\d+)/i,Z=/\.((js)|(jscript))$/i,$=/\.(css)$/i,Y=/([a-zA-Z0-9\.]*:)\/\/([^\/]+)\/?/,O="unknown",B="ie",T="ff",R="cr",V="sf";J();var C={map:{},R:function(a){for(var b in this.H)if(this.H[b]===a)return b;return null},I:function(a,b){if(h(a)!==m)throw Error("The alias must be a string.");if(a===b)return this;var c;this.map[a]||(this.map[a]=[]);switch(h(b)){case m:this.map[a].push(b);
break;case k:(b.d===q||b.d)&&this.map[a].push(b.src);break;case x:for(c=0;c<b.length;c++)this.map[a].push(b[c]);break;case y:for(c=0;c<b.length;c++)(b[c].d===q||b[c].d)&&this.map[a].push(b[c].src)}return this},h:function(a){var b=[],c;switch(h(a)){case m:if(this.map[a])for(c=0;c<this.map[a].length;c++)v(b,this.h(this.map[a][c]));break;case k:(a.d===q||a.d)&&v(b,this.h(a.src));break;case x:for(c=0;c<a.length;c++)v(b,this.h(a[c]));break;case y:for(c=0;c<a.length;c++)(a[c].d===q||a[c].d)&&v(b,this.h(a[c].src));
break;default:throw Error("Alias is not a recognized type.");}return 0===b.length?[a]:b}};G(u.prototype,{src:null,type:r,k:!1,status:0,e:null,b:null,g:null,a:null,K:function(){if(6!==this.status){var a;for(a=this.e.length-1;0<=a;a--)this.e[a].matches(this)&&this.e.splice(a,1);for(a=this.b.length-1;0<=a;a--)this.b[a].matches(this)&&this.b.splice(a,1);delete this.e;delete this.b;delete this.g;delete this.a;delete this.a;delete this.src;delete this.type;delete this.k;this.status=6}},j:function(){if(4===
this.status){var a;if(this.A()){this.status=7;for(a=0;a<this.b.length;a++)this.b[a].j();for(a=0;a<this.g.length;a++)this.g[a]();for(a=0;a<this.e.length;a++)this.e[a].j();if(s.O())for(a=0;a<F.length;a++)F[a]()}}},A:function(){if(4!==this.status&&7!==this.status)return!1;for(var a=this.b.length-1;0<=a;a--)if(!this.b[a].A())return!1;return!0},o:function(a){if(!a||a.constructor!==u)throw Error("The other dependency must be a valid Dependency object.");this.matches(a)||(-1===A(this.b,a)&&(a.e.push(this),
this.b.push(a)),4===a.status&&this.j())},n:function(a){if("function"!==h(a))throw Error("dependency resolution callback function must be a function.");4===this.T?a():this.g.push(a)},matches:function(a){var b=h(a);if(b===m)return this.src===a;if(b===k)return this.src===a.src&&this.type==a.type},B:function(a){this.k=!0;if(this.matches(a))return this;var b,c;for(b=0;b<this.u.length;b++)if(!this.u[b].k&&(c=this.u[b].B(a)))return c;for(b=0;b<this.t.length;b++)if(!this.t[b].k&&(c=this.t[b].B(a)))return c;
return null},N:function(a){if(!this.matches(a)){var b=A(this.b,a);0<=b&&this.b.splice(b,1);b=A(a.e,this);0<=b&&a.e.splice(b,1)}},m:function(){if(3===this.status){var a,b,c,d,e;c=E.splice(0,E.length);for(a=0;a<c.length;a++)if(d=c[a],d.type===z&&6!==d.status){for(b=d.b.length-1;0<=b;b--)e=d.b[b],this.o(e),d.N(e);for(b=d.g.length-1;0<=b;b--)this.n(d.g[b]);s.D(d)}this.status=4;6!==this.status&&this.j()}},load:function(){var a=this;a.status=2;if(a.type===r)a.a=w.createElement("script"),a.a.src=K(a.src,
a.type),a.a.type="text/javascript",a.a.defer=!1,a.a.async=!0;else if(a.type===l)a.a=w.createElement("link"),a.a.type="text/css",a.a.href=K(a.src,a.type),a.a.rel="stylesheet";else throw Error("Attempting to load an unsupported file type: "+this.type);g.i.name===B&&9>g.i.version?a.a.onreadystatechange=function(){if("complete"===a.a.readyState||"loaded"===a.a.readyState)a.a.onreadystatechange=null,a.status=3,a.m()}:a.a.addEventListener("load",function(){a.status=3;a.m()},!0);w.getElementsByTagName("head")[0].appendChild(this.a)},
p:function(){if(0!==this.status)throw Error("Attempting to initiate a previously initiated dependency.");this.status=1;this.type!==z&&this.type!==D?this.load():this.j()}});var s={c:{},r:0,P:function(){for(var a in this.c)this.c[a].k=!1},empty:function(){return 0===this.r},L:function(){var a,b;for(a in this.c)if(b=this.c[a],b.a&&"interactive"===b.a.readyState)return b;return null},q:function(a){switch(h(a)){case m:return this.c[a]||null;case k:return this.c[a.src]||null;default:return null}},s:function(a){if(!this.q(a))switch(h(a)){case k:this.c[a.src]=
a}this.r++;return this},D:function(a){switch(h(a)){case m:return this.D(this.q(a));case k:delete this.c[a.src],a.K()}return this},m:function(){for(var a in this.c)this.c[a].Q||this.c[a].m()},O:function(){var a,b;for(a in this.c)if(b=this.c[a].status,7!==b&&5!==b&&6!==b)return!1;return!0}},F=[],aa=0;e.C=function(a){F.push(a)};e.ready=e.C;e.J=function(){J();return e};e.config=e.J;e.d=function(a,b,c){a&&e(b,c);return e};e.conditionally=e.d;e.l=function(a,b){var c=C.h(a);1===c.length&&c[0]===a&&C.I(a,
b);return e};e.alias=e.l;e.f=function(a,b){var c;switch(h(a)){case m:return e(a+"."+l,b);case k:return a.src+="."+l,a.type=l,e(a,b);case x:for(c=0;c<a.length;c++)a[c]+="."+l;return e(a,b);case y:for(c=0;c<a.length;c++)a[c].src+="."+l,a[c].type=l;return e(a,b);default:throw Error("Valid dependencies must be entered");}};e.css=e.f;e.f.d=function(a,b,c){a&&e.f(b,c);return e};e.css.conditionally=e.f.d;e.f.l=function(a,b){return e.l(a,b)};e.css.alias=e.f.l;g.M||(f.using=e);g.w&&e(g.w);g.v&&e.f(g.v);return e})(window||
global,(window||global).using?using.configuration:null);
